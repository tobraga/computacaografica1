<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Praça js</title>
    <style>
      html, body {
         margin: 0;
         height: 100%;
      }
      
      </style>
</head>
<body>
  <script src="../js/three.js"></script>
  <script src="/js/GLTFLoader.js"></script>
  <script src="/js/OrbitControls.js"></script>
  <script >
// função de inicialização
// Cena
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x2b2a24);

// Camera
//const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
const camera = new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,5000);
//camera.rotation.y = 45/180*Math.PI;
camera.position.x = 50;
camera.position.y = 65;
camera.position.z = 50;




// Loader de Textura
const textureLoader = new THREE.TextureLoader();

// Renderizador
const renderer = new THREE.WebGLRenderer({antialias:true});
//renderer.shadowMap.enabled = true;
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Controlador de camera
const controlador = new THREE.OrbitControls(camera,renderer.domElement);
controlador.update();
controlador.enableDamping = true;
//controlador.addEventListener('change', renderer);


// Loader de GLTF
const gltfLoader = new THREE.GLTFLoader();


// Luzes

// Luz ambiente para todo cenário
var hLight = new THREE.AmbientLight(new THREE.Color(0xFFFFFF), 1);
scene.add(hLight);
// Luz Direcional
var directionalLight = new THREE.DirectionalLight(new THREE.Color(0xFFFFFF), 1);

// Luz de ponto
var spotLight = new THREE.SpotLight(new THREE.Color(0xFFFFFF), 1);

// Luzes dos postes
var pointLight = new THREE.PointLight(0xc4c4c4,10);

spotLight.castShadow = true;
spotLight.target.position.set(0,0,0);
spotLight.position.set(30,100,10);
scene.add(spotLight);
scene.add(spotLight.target);

/*
light.shadow.camera.zoom = 0.1;
light.shadow.mapSize.width = 2048;
light.shadow.mapSize.height = 2048;
*/
//light.shadow.mapSize.width = 1024;
//light.shadow.mapSize.height = 1024;
//scene.add(light);

// Ajudante de Luzes
var ajudante = new THREE.PointLightHelper(spotLight);
scene.add(ajudante);

var ajudante2 = new THREE.CameraHelper(spotLight.shadow.camera);
scene.add(ajudante2);

// Ajudante de direção x,y,z
const axesHelper = new THREE.AxesHelper( 70);
scene.add( axesHelper );

// Funções

// Grama
function CriarGrama(){
  var g = new THREE.PlaneGeometry(50,50);
  var t = textureLoader.load('../assets/grama.jpg');
  t.wrapS = THREE.RepeatWrapping;
  t.wrapT = THREE.RepeatWrapping;
  t.magFilter = THREE.NearestFilter;
  t.repeat.set(12,12);
  
  var ma = new THREE.MeshPhongMaterial({map: t, side: THREE.DoubleSide});
  var p = new THREE.Mesh(g, ma);
  p.rotation.x = Math.PI * -.5;
  scene.add(p);
  
  p.position.y = 0;
  p.receiveShadow = true;
}

//Circulo Central
function CriarCentro(){
  var geometria = new THREE.CircleGeometry(10,128);
  //var t = loader.load('../assets/street+asphalt-1024x1024.png');
  //t.wrapS = THREE.RepeatWrapping;
  //t.wrapT = THREE.RepeatWrapping;
  //t.magFilter = THREE.NearestFilter;
  //t.repeat.set(12,12);
  
  var material = new THREE.MeshToonMaterial({color: 0x9E5020});
  var pista = new THREE.Mesh(geometria, material);
  pista.rotation.x = Math.PI * -.5;
  scene.add(pista);
  
  pista.position.y = 0.1;
  pista.receiveShadow = true;
}

// Load de Arvore 3d
function Arvore1(){
  gltfLoader.load('/assets/giant_low_poly_tree/scene.gltf', function(gltf){
  var tree = gltf.scene.children[0];
  tree.position.set(20,0.1,20);
  tree.scale.set(0.5,0.5,0.5);
  scene.add(gltf.scene);
  gltf.animations; // Array<THREE.AnimationClip>
	gltf.scene; // THREE.Group
	gltf.scenes; // Array<THREE.Group>
	gltf.cameras; // Array<THREE.Camera>
	gltf.asset;
  //renderer.render(scene,camera);
  //animacao();
});
}
function Arvore2(){
  gltfLoader.load('/assets/giant_low_poly_tree/scene.gltf', function(gltf){
  var tree = gltf.scene.children[0];
  tree.position.set(-10,0.1,-20);
  tree.scale.set(0.5,0.5,0.5);
  scene.add(gltf.scene);
  gltf.animations; // Array<THREE.AnimationClip>
	gltf.scene; // THREE.Group
	gltf.scenes; // Array<THREE.Group>
	gltf.cameras; // Array<THREE.Camera>
	gltf.asset;
  //renderer.render(scene,camera);
  //animacao();
});
}
function Banco1(){
  gltfLoader.load('/assets/classic_park_bench_low_poly/scene.gltf', function(gltf){
  var banco = gltf.scene.children[0];
  banco.position.set(2,2.5,-10);
  banco.scale.set(5,5,5);
  scene.add(gltf.scene);
  gltf.animations; // Array<THREE.AnimationClip>
	gltf.scene; // THREE.Group
	gltf.scenes; // Array<THREE.Group>
	gltf.cameras; // Array<THREE.Camera>
	gltf.asset;
  //renderer.render(scene,camera);
  //animacao();
});
}
function Banco2(){
  gltfLoader.load('/assets/classic_park_bench_low_poly/scene.gltf', function(gltf){
  var banco = gltf.scene.children[0];
  banco.position.set(2,2.5,10);
  banco.rotation.z = 3.14159;
  banco.scale.set(5,5,5);
  scene.add(gltf.scene);
  gltf.animations; // Array<THREE.AnimationClip>
	gltf.scene; // THREE.Group
	gltf.scenes; // Array<THREE.Group>
	gltf.cameras; // Array<THREE.Camera>
	gltf.asset;
  //renderer.render(scene,camera);
  //animacao();
});
}
function Poste(){
  gltfLoader.load('/assets/lamp_post/scene.gltf', function(gltf){
  var tree = gltf.scene.children[0];
  tree.position.set(0,0,0);
  tree.scale.set(0.2,0.2,0.2);
  scene.add(gltf.scene);
  gltf.animations; // Array<THREE.AnimationClip>
	gltf.scene; // THREE.Group
	gltf.scenes; // Array<THREE.Group>
	gltf.cameras; // Array<THREE.Camera>
	gltf.asset;
  //renderer.render(scene,camera);
  //animacao();
});
}

function animacao() {
  renderer.render(scene,camera);
  requestAnimationFrame(animacao);
  //controlador.update();
  
  
}

CriarGrama();
CriarCentro();

Arvore1();
Arvore2();
Banco1();
Banco2();
Poste();
animacao();

  </script>
</body>

</html>